<html>
<head>
	<link rel="stylesheet" href="./css\tbl.css">
	<link rel="stylesheet" type="text/css" href="./css/form.css">
	<link rel="stylesheet" href="./css\account.css">
	<link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css">
	<link rel="stylesheet" href="./css\glyphicons-font-awesome-migrate.min.css">
	<link rel="stylesheet" type="text/css" href="./css/portalbasictheme.css">
	<link rel="stylesheet" type="text/css" href="./css/theme.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./css/sb-admin.css">
     <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
    crossorigin="anonymous">
</head>
<body>
	<div id="content-wrapper">

        <div class="container-fluid">
			<h1><b>Registar Evento</b></h1>
			<br>
			<div>
			<form action="http://localhost:8080/evento" method="POST">
				<h3>Seleccionar Evento</h3>
				<select name="tipo" id="tipo">
					<option value="musica">Música</option>
					<option value="teatro">Teatro</option>
					<option value="danca">Dança</option>
				</select>
				<label for="start">Data de concretização:</label>

				<input type="date" id="start" name="data_inicio"
		       value="today"
		       min="today" max="2022-12-31">
				<br>
				<div id="myForm"></div>
				
			<button onclick="validateSelection()">SUBMIT</button>
			</form>
		</div>
			<br>
		</div></div>
			<script type="text/javascript">

		function validateSelection(){
			console.log("VALIDATION!")
			var checkboxes=document.getElementsByName("tipo");
			console.log(checkboxes.length)
			var numOfCheckedItems=0

			for(var i=0;i<checkboxes.length;i++){
				if(checkboxes[i].checked)
					numOfCheckedItems++;
			}
			if(numOfCheckedItems>2)
				alert("Só pode seleccionar um técnico!");
			else{
				console.log("VALIDATE")
			}
		}

		window.onload=()=>{
			var showToday=document.getElementByValue("today");
			var today = new Date();
			var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
			var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
			var dateTime = date+' '+time;
			showToday.innerHTML(dateTime);

		console.log(Date())

			const renderTecs=async()=>{

			const myForm=document.getElementById("myForm")

			let strHtml='<form action="http://localhost:8080/evento" method="POST"><h3>Escolha um evento</h3><br><h4>Descricao</h4><input id="descricao" name="descricao"></input>'

			/*strHtml+=`<input type="date" id="start" name="trip-start"
       			value="2018-07-22"
       			min="2018-01-01" max="2018-12-31">
				<br>
				<div id="myForm"></div>`*/

			const response = await fetch('http://localhost:8080/eventos')

			const eventos = await response.json()

			for(const evento of eventos){

				strHtml+=`<h4>${evento.tipo}</h4><input type="checkbox" id="idEvento" name="idEvento" value=${evento.idEvento}>`

			}

			myForm.innerHTML=strHtml
		}
		renderTecs();
	}
	</script>
</body>
</html>